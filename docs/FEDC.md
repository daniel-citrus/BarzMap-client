# Front-End Data Contracts (FEDC)

## Scope
This document captures the data that the current UI components expect so backend contracts can be designed with confidence. It covers:
- `src/features/parkSubmission/ParkSubmissionDashboard.jsx` and its nested moderation viewer
- `src/hooks/MapLibre Hooks/useMapHelpers.jsx`
- `src/features/events/EventsBoard.jsx`

All timestamps should be ISO-8601 strings (UTC). IDs are opaque strings generated by the backend. Unless otherwise stated, arrays return empty (`[]`) when no data exists.

## ParkSubmissionDashboard.jsx
### Overview
The dashboard renders a paginated feed of park submissions, exposes moderation status badges, and opens a detail viewer with approve/deny/pending actions. The viewer reuses the same submission object and expects full detail in one payload.

### Collection Feed
`GET /api/admin/park-submissions`

| Query Param | Type | Notes |
| --- | --- | --- |
| `status` | `string` | Optional; one of `pending`, `approved`, `denied`, `all` (default `pending`). |
| `search` | `string` | Optional fuzzy match on title, submitter, or address. |
| `page` | `number` | Starts at `1`. |
| `pageSize` | `number` | Default `20`; allow up to `100`. |

```json
{
  "data": [
    {
      "id": "SUB-10342",
      "title": "Bayview Fitness Parc",
      "description": "Waterfront calisthenics spot featuring multiple rigs and sunrise views over the bay.",
      "address": "842 Marina Vista, San Francisco, CA 94109",
      "equipment": ["Pull-up Bars", "Dip Bars", "Push-up Bars"],
      "images": ["https://cdn.example.com/submissions/SUB-10342/1.jpg"],
      "submittedAt": "2024-08-24T15:36:00Z",
      "submitter": "dcitrus4",
      "moderationComment": "",
      "status": "pending"
    }
  ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "totalPages": 8,
    "totalItems": 152
  }
}
```

### Submission Detail Viewer
The dashboard currently searches within the already-loaded submissions. To avoid stale data, prefer loading a fresh record before opening the viewer.

`GET /api/admin/park-submissions/{submissionId}`

```json
{
  "id": "SUB-10342",
  "title": "Bayview Fitness Parc",
  "parkName": "Bayview Fitness Parc",
  "description": "Waterfront calisthenics spot featuring multiple rigs and sunrise views over the bay.",
  "parkDescription": null,
  "address": "842 Marina Vista, San Francisco, CA 94109",
  "parkAddress": null,
  "equipment": ["Pull-up Bars", "Dip Bars", "Push-up Bars"],
  "images": ["https://cdn.example.com/submissions/SUB-10342/1.jpg"],
  "submittedAt": "2024-08-24T15:36:00Z",
  "date": null,
  "submitter": "dcitrus4",
  "user": null,
  "moderationComment": "",
  "status": "pending",
  "metadata": {
    "notes": null,
    "attachments": []
  }
}
```

Field handling:
- `title` or `parkName` populate the heading; provide both when possible.
- `description` or `parkDescription` supplies the body copy.
- `address` or `parkAddress` fills the address block.
- `submitter` or `user` is shown under the timestamp.
- `status` should stay lowercase (`pending`, `approved`, `denied`) for badge logic.
- `images` array controls the carousel. Broken URLs should return HTTP 404 to trigger the fallback UI.

### Moderation Actions
All moderation routes return the updated submission object (same shape as the detail response) so the UI can refresh instantly.

`POST /api/admin/park-submissions/{submissionId}/approve`

`POST /api/admin/park-submissions/{submissionId}/deny`

`POST /api/admin/park-submissions/{submissionId}/pending`

```json
{
  "adminComment": "Looks great—double-check lighting schedule."
}
```

`DELETE /api/admin/park-submissions/{submissionId}`

| Behavior | Notes |
| --- | --- |
| Comment optionality | Empty string is acceptable; backend should trim. |
| Idempotency | Repeating an action with the same resulting status returns `200` with the current record. |
| Audit | Consider capturing `moderatedBy` and `moderatedAt` for future UI expansion. |

### Status Reference
```
pending -> awaiting review
approved -> visible to end users
denied -> rejected; remains in list for audit history
```

Invalid statuses must surface as `400` to keep UI messaging accurate.

## useMapHelpers.jsx
### Purpose
Provides a `getFeaturesWithinBounds` helper. When wired to the backend the hook should request GeoJSON features constrained by the map viewport.

### Bounding-Box Search
`GET /api/parks`

| Query Param | Type | Notes |
| --- | --- | --- |
| `bbox` | `string` | Required; `west,south,east,north` (comma separated floats). |
| `equipment` | `string` | Optional comma-separated filter. |
| `updatedSince` | `string` | Optional ISO-8601 timestamp for incremental updates. |

```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "parkId": "PRK-0091",
        "name": "Eastshore Park",
        "address": "2930 Grand Ave, Oakland, CA 94610",
        "equipment": ["Pull Up Bars", "Dip Bars"],
        "lastUpdated": "2024-08-01T12:04:00Z"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [-122.24892, 37.80975]
      }
    }
  ]
}
```

Implementation notes:
- Response must always be valid GeoJSON; empty results return an empty `features` array.
- Use `200` with an empty collection when the bbox covers no parks.
- If the bbox is malformed return `400` with a message (`{ "error": "Invalid bbox format" }`).
- Rate-limit requests (frontend can debounce user panning).

## EventsBoard.jsx
### Overview
Renders a list of nearby or curated events. The component works with the events passed via props or falls back to a default list, so the backend should supply the whole array.

### Events Feed
`GET /api/events`

| Query Param | Type | Notes |
| --- | --- | --- |
| `lat` / `lng` | `number` | Optional; pairs enable distance calculations. |
| `radius` | `number` | Optional; miles or kilometers (document which unit is used). |
| `limit` | `number` | Default `10`. |
| `fromDate` | `string` | Optional ISO-8601; omit past events. |

```json
{
  "data": [
    {
      "id": "EVT-2401",
      "parkName": "Bayview Fitness Parc",
      "address": "842 Marina Vista, San Francisco, CA 94109",
      "distance": "0.8 mi away",
      "date": "2024-09-14",
      "time": "09:00",
      "description": "Community sunrise stretch and mobility circuit led by local trainers.",
      "host": "Bayview Movement Collective",
      "ctaLabel": "View event"
    }
  ]
}
```

Formatting expectations:
- `date` and `time` can be rendered separately; if `time` is omitted the UI shows `Date TBA`.
- `distance` is a formatted string; if the backend prefers returning meters, add a numeric `distanceMeters` and let the client format the label.
- `ctaLabel` defaults to `"View event"` when missing.

### Error Handling
- Empty collections should return `200` with `"data": []`. The component already prints “Check back soon!”.
- Validation failures (e.g., missing lat or lng when radius supplied) should return `400` with an `error` string.

---
Backend implementers can wire these routes immediately and replace the current static samples without additional UI work.
